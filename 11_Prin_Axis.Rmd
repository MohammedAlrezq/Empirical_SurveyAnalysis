---
title: "11_Prin_Axis"
author: "Mohammed Alrezq"
date: "2023-08-03"
output:
  word_document: default
  html_document: default
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# 1. Preliminary 
## 1.1 Load libraires 
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(psych)# use perform EFA
library(purrr)
library(ggplot2)
library(gridExtra)# to arrnge plot per row and col
library(corrr)
```


```{r}
plotTheme <- function() {
  theme(
    plot.title = element_text(size = 14, family = "sans", face = "plain", hjust = 0),
    plot.subtitle=element_text(size = 11, family = "sans", hjust = 0),
    plot.caption=element_text(size = 10, family = "sans", face = "italic", hjust = 0), 
    axis.title.x = element_text(size = 10, family = "sans", face = "plain", hjust = 1, vjust = -0.5),
    axis.title.y = element_text(size = 10, family = "sans", face = "plain", hjust = 1, vjust = 1),
    axis.text = element_text(size = 9, family = "sans", face = "plain"),
    panel.background = element_blank(),
    panel.grid.minor = element_line(colour = "gray"),
    panel.grid.major = element_line(colour = "gray"),
    axis.ticks = element_blank(),
    legend.title = element_text(size = 10, family = "sans"),
    legend.text = element_text(size = 9, family = "sans"),
    axis.line = element_blank()
  )
}
```

## 1.2 load data
```{r}
model_11 <- read.csv("mean_data.csv")

# Remove Response.ID and col X from the data 
model_11 <- model_11 |> 
  select(c(-Response.ID, -X))

# Convert all integer columns to numeric
model_11 <- model_11 |> 
  mutate_if(is.integer, as.numeric)
```
# 2 Statistical descriptive
## 2.1 Statistical summary  
```{r}
describe(model_11)
```
## 2.2 Correlation matrix 
```{r}
model_11_Corr <- round(cor(model_11), 2) # Correlation matrix

#write.csv(model_11_Corr, "correlation_mtx.csv")
```

# 3 Diagnostic Test 
## 3.1 Kaiser-Meyer-Olkin index (KMO)

**Kaiser’s 1974 recommendations were:**
- bare minimum of .5
- values between .5 and .7 as mediocre
- values between .7 and .8 as good
- values above .9 are superb
```{r}
KMO(model_11)

# KMO = 0.86
# Item level > 0.50
```
## 3.2 Bartlett’s test
```{r}
psych::cortest.bartlett(model_11)
# P-value < 0.05 which supports PAF
```
## 3.3 Determinant of the correlation matrix
- For multicollinearity or singularity in my data
- Det. of the correlation matrix should be greater than 0.00001
```{r}
det(cor(model_11))
```

```{r}
#EMPL_SKI and ORG_IMP = 0.79
#EMPL_SAT and STAKEH_ACC = 0.75
#DVs = 5

#IVs
##CONTX_CUS and TOOL_AP = 0.78
#LD_SUP and CULT_INTG =0.75
#LD_STL and LD_INV =0.75
#INSTIT and ACT_INTG=0.75
#TEAM_ST and LD_STL=.75



model_11_reduced <- model_11 |> 
  select(-c(EMPL_SKI, ORG_IMP, CONTX_CUS, TOOL_AP))
det(cor(model_11_reduced))
# Any correlation >= 0.75 was removed 
model_11_reduced_2 <- model_11 |> 
  select(-c(EMPL_SKI, ORG_IMP, EMPL_SAT, STAKEH_ACC, LD_SUP, CULT_INTG, LD_STL, LD_INV, INSTIT, ACT_INTG, TEAM_ST, CONTX_CUS, TOOL_AP))
det(cor(model_11_reduced_2))


#ORG_IMP and IMPL_SUCC
#EMPL_SAT and IMPL_SUCC
#EMPL_SAT and ORG_IMP
# EMP_ATT nd EMPL_BEL
# PRJ_SEL and TASK_COMP
#DEF_MEA and PRJ_SEL
#ORG_CHR and DEF_MEA
#DAT_QLT and DEF_MEA
#SCOPE and EFT_REQ

model_11_reduced_3 <- model_11 |> 
  select(-c(EMPL_SKI, ORG_IMP, EMPL_SAT, STAKEH_ACC, LD_SUP, CULT_INTG, LD_STL, LD_INV, INSTIT, ACT_INTG, TEAM_ST, CONTX_CUS, TOOL_AP, IMPL_SUCC, EMP_ATT, EMPL_BEL, PRJ_SEL, TASK_COMP, DEF_MEA, ORG_CHR, DAT_QLT, SCOPE, EFT_REQ))
det(cor(model_11_reduced_3))

det(model_11_Corr)

```
# Split the data to DV and IV

```{r}
names(model_11)
mode_11_DVs <- model_11 |> 
  select(1:13)

model_11_IVs <- model_11 |> 
  select(14:42)
```

# cHECK 
## Dependent variabels 

```{r}
# Correlation matrix 
model_11_DVs_Corr <- round(cor(mode_11_DVs), 2)

#Kaiser-Meyer-Olkin index (KMO)
KMO(mode_11_DVs)

#Bartlett’s test
psych::cortest.bartlett(mode_11_DVs)

#Determinant of the correlation matrix
# - For multicollinearity or singularity in my data
# - Det. of the correlation matrix should be greater than 0.00001
det(cor(mode_11_DVs))
# 0.0000018
```
## Independent variabels 
```{r}
# Correlation matrix 
model_11_IVs_Corr <- round(cor(model_11_IVs), 2)
#write.csv(model_11_IVs_Corr, "IVs_Correaltion.csv")

#Kaiser-Meyer-Olkin index (KMO)
KMO(model_11_IVs)

#Bartlett’s test
psych::cortest.bartlett(model_11_IVs)

#Determinant of the correlation matrix
# - For multicollinearity or singularity in my data
# - Det. of the correlation matrix should be greater than 0.00001
det(cor(model_11_IVs))
# 2.8*10^-12
```

## Independent variables
- remove correlated variables with 0.73 or above 
```{r}

# remove CONTX_CUS and TOOL_AP
# LD_STL and LD_INV = 0.78
#LD_STL and TEAM_ST =0.75
#ORG_CUL and LD_SUP = 0.74
#DEF_MEA and PRJ_SEL =0.73
# SCOPE and EFT_REQ = 0.73
# LD_STL and LD_SUP = 0.72
# ORG_CHR and DEF_MEA = 0.72

model_11_IVs_reduced <- model_11_IVs |> 
  select(-c(CONTX_CUS, TOOL_AP, LD_STL, TEAM_ST, LD_INV, ORG_CUL, LD_SUP, SCOPE, EFT_REQ, LD_STL, LD_SUP, ORG_CHR, DEF_MEA))
det(cor(model_11_IVs_reduced))

#Kaiser-Meyer-Olkin index (KMO)
KMO(model_11_IVs_reduced)

#Bartlett’s test
psych::cortest.bartlett(model_11_IVs_reduced)

```



