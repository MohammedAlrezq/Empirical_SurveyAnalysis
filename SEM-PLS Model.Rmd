---
title: "SEM-PLS"
author: "Mohammed Alrezq"
date: "2023-10-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("seminr")
library(seminr)
library(tidyverse)
library(psych)
```


# Download data 
```{r}
sem_plsData <- read.csv("sem_plsData.csv")
# remove extra column 
sem_plsData <- sem_plsData |>
  select(-1)
names(sem_plsData)
```

# Rename items
```{r}
sem_plsData <- sem_plsData |> 
  rename(TS1 = EMPL_SAT_9,
         TS2 = ORG_IMP_12,
         TS3 = STAKEH_ACC_4,
         TS4 = EMPL_SKI_8,
         TS5 = DEC_IMP_13,
         TS6 = BUSI_IMP_11,
         TS7 = IMPL_SUCC_1,
         TS8 = EMPL_BEL_10,
         DS1 = DEPLOY_6,
         DS2 = ACT_INTG_7,
         IPS1 = BUDG_COMP_2,
         IPS2 = TASK_COMP_3,
         IR1 = TOOL_AP_13,
         IR2 = CONTX_CUS_14,
         IR3 = EFT_REQ_15,
         IR4 = EMP_ENG_12,
         IR5 = EXP_CON_20,
         IR6 = CUS_IDEF_26,
         SII1 = TRA_EDUC_18,
         SII2 = PAT_RES_24,
         SII3 = WKF_SKL_19,
         SII4 = RES_AVL_4,
         SL1 = LD_STL_9,
         SL2 = LD_INV_5,
         SL3 = LD_SUP_1,
         MBI1 = DAT_QLT_11,
         MBI2 = DEF_MEA_7,
         MBI3 = PRJ_SEL_6,
         CA1 = EMP_ATT_3,
         CA2 = UND_CNG_22)

names(sem_plsData)

# Reorder the columns in the dataframe to run
sem_plsData <- sem_plsData |> 
  select(TS1, TS2, TS3, TS4, TS5, TS6, TS7, TS8, DS1, DS2, IPS1, IPS2, IR1, IR2, IR3, IR4, IR5, IR6, SII1, SII2, SII3, SII4, SL1, SL2, SL3, MBI1, MBI2, MBI3, CA1, CA2)
```


# Create measurment model 
```{r}
meas_model <- constructs(
  composite("Transformation_Success", multi_items("TS", 1:8), weights = mode_A),
  composite("Deployment_Success", multi_items("DS", 1:2), weights = mode_A),
  composite("Improvement_Project_Success", multi_items("IPS", 1:2), weights = mode_A),
  composite("Improvement_Readiness", multi_items("IR", 1:6), weights = mode_A),
  composite("Sustainable_Improvement_Infrastructure", multi_items("SII", 1:4), weights = mode_A),
  composite("Supportive_Leadership", multi_items("SL", 1:3), weights = mode_A),
  composite("Measures_based_Improvement", multi_items("MBI", 1:3), weights = mode_A),
  composite("Change_Awareness", multi_items("CA", 1:2), weights = mode_A)
)

```

# Create structural model 
```{r}
struc_model <- relationships(
  paths(from = c("Improvement_Readiness", "Sustainable_Improvement_Infrastructure", "Supportive_Leadership", "Measures_based_Improvement", "Change_Awareness"), to = c("Transformation_Success", "Deployment_Success", "Improvement_Project_Success")
        ))

  
```

# Estimate the model
```{r}
model_est <- estimate_pls(sem_plsData, measurement_model = meas_model, structural_model = struc_model,inner_weights = path_weighting)

summary(model_est)
```


